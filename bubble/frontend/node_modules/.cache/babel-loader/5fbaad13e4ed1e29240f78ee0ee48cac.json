{"ast":null,"code":"import { useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare callback for a Delete button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@material-ui/icons/Delete';\n * import { Button, useDeleteWithUndoController } from 'react-admin';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const { loading, handleDelete } = useDeleteWithUndoController({\n *         resource,\n *         record,\n *         basePath,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Button\n *             onClick={handleDelete}\n *             disabled={loading}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\n\nvar useDeleteWithUndoController = function (props) {\n  var record = props.record,\n      basePath = props.basePath,\n      _a = props.redirect,\n      redirectTo = _a === void 0 ? 'list' : _a,\n      onClick = props.onClick,\n      onSuccess = props.onSuccess,\n      onFailure = props.onFailure;\n  var resource = useResourceContext(props);\n  var notify = useNotify();\n  var redirect = useRedirect();\n  var refresh = useRefresh();\n\n  var _b = useDelete(resource, null, null, {\n    action: CRUD_DELETE,\n    onSuccess: onSuccess !== undefined ? onSuccess : function () {\n      notify('ra.notification.deleted', 'info', {\n        smart_count: 1\n      }, true);\n      redirect(redirectTo, basePath || \"/\" + resource);\n      refresh();\n    },\n    onFailure: onFailure !== undefined ? onFailure : function (error) {\n      notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', 'warning', {\n        _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n      });\n      refresh();\n    },\n    mutationMode: 'undoable'\n  }),\n      deleteOne = _b[0],\n      loading = _b[1].loading;\n\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    deleteOne({\n      payload: {\n        id: record.id,\n        previousData: record\n      }\n    });\n\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, onClick, record]);\n  return {\n    loading: loading,\n    handleDelete: handleDelete\n  };\n};\n\nexport default useDeleteWithUndoController;","map":{"version":3,"sources":["/node_modules/ra-core/esm/controller/button/useDeleteWithUndoController.js"],"names":["useCallback","useDelete","CRUD_DELETE","useRefresh","useNotify","useRedirect","useResourceContext","useDeleteWithUndoController","props","record","basePath","_a","redirect","redirectTo","onClick","onSuccess","onFailure","resource","notify","refresh","_b","action","undefined","smart_count","error","message","_","mutationMode","deleteOne","loading","handleDelete","event","stopPropagation","payload","id","previousData"],"mappings":"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","sourcesContent":["import { useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect, } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare callback for a Delete button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@material-ui/icons/Delete';\n * import { Button, useDeleteWithUndoController } from 'react-admin';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const { loading, handleDelete } = useDeleteWithUndoController({\n *         resource,\n *         record,\n *         basePath,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Button\n *             onClick={handleDelete}\n *             disabled={loading}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\nvar useDeleteWithUndoController = function (props) {\n    var record = props.record, basePath = props.basePath, _a = props.redirect, redirectTo = _a === void 0 ? 'list' : _a, onClick = props.onClick, onSuccess = props.onSuccess, onFailure = props.onFailure;\n    var resource = useResourceContext(props);\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var refresh = useRefresh();\n    var _b = useDelete(resource, null, null, {\n        action: CRUD_DELETE,\n        onSuccess: onSuccess !== undefined\n            ? onSuccess\n            : function () {\n                notify('ra.notification.deleted', 'info', { smart_count: 1 }, true);\n                redirect(redirectTo, basePath || \"/\" + resource);\n                refresh();\n            },\n        onFailure: onFailure !== undefined\n            ? onFailure\n            : function (error) {\n                notify(typeof error === 'string'\n                    ? error\n                    : error.message || 'ra.notification.http_error', 'warning', {\n                    _: typeof error === 'string'\n                        ? error\n                        : error && error.message\n                            ? error.message\n                            : undefined,\n                });\n                refresh();\n            },\n        mutationMode: 'undoable',\n    }), deleteOne = _b[0], loading = _b[1].loading;\n    var handleDelete = useCallback(function (event) {\n        event.stopPropagation();\n        deleteOne({\n            payload: { id: record.id, previousData: record },\n        });\n        if (typeof onClick === 'function') {\n            onClick(event);\n        }\n    }, [deleteOne, onClick, record]);\n    return { loading: loading, handleDelete: handleDelete };\n};\nexport default useDeleteWithUndoController;\n"]},"metadata":{},"sourceType":"module"}